g.V().hasLabel('user').has('id', 'user7').outE('rates').has('weight', gt(2)).inV().as('exclude').inE('rates').has('weight', gt(4)).outV().dedup().outE('rates').has('weight', gt(4)).inV().dedup().where(neq('exclude')).order().by(inE('rates').count(), decr).values('title').dedup().limit(10)